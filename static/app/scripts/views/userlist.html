<div class="fluid-container collection-container">
    <div class="fluid-container collection-edit" ng-class="{visible: toggles.editTab}">
        <button class="btn btn-danger edit-button pull-right" ng-click="toggleEditTab()">Angre</button>
        <button class="btn btn-primary edit-button pull-right" ng-click="updateCollection()">Lagre</button>
        <label for="collection-image">Bilde av liste</label>
        <div class="image-row">
            <div class="dropzone profile-image" file-dropzone="[image/jpeg]"
                          file="imageInfo.image" file-name="imageInfo.imageFileName" data-max-file-size="5" report="reportImage">
              <span>Dra inn bilde her. Anbefalt oppløsning 400x400.</span>
            </div>
            <div class="image-container profile-image" ng-style="{
            'background-image': 'url(/userImages/' + editCollection.collectionImageId + '.jpg)'
            }">
            </div>
        </div>
        <form>
            <div class="form-group">
                <label for="collection-title">Tittel på liste</label>
                <input type="text" class="form-control" id="collection-title" placeholder="skriv inn tittel.." ng-model="editCollection.title">
            </div>
            <div class="form-group">
                <label for="collection-description">Beskrivelse av liste</label>
                <textarea type="text" class="form-control" id="collection-description" placeholder="beskrivelse.." ng-model="editCollection.description"></textarea>
            </div>
        </form>
    </div>
    <div class="fluid-container collection-header clearfix">
        <button class="btn btn-default edit-button pull-right" ng-click="toggleEditTab()">Rediger</button>
        <div ng-if="collection.collection.collectionImageId" class="collection-photo" ng-style="
            {'background-image': 'url(userImages/' + collection.collection.collectionImageId + '.jpg)'}">
             
        </div>
        <div class="collection-photo" ng-if="!collection.collection.collectionImageId" ng-style="
            {'background-image': 'url(userImages/' + collection.collection.collectionImageId + '.jpg)'}">
             
        </div>
        <div class="collection-title">
            <p class="kicker">
                <span ng-if="collection.collection.type == 'collections'">Samling</span>
                <span ng-if="collection.collection.type == 'goals'">Samlemål</span>
                <span ng-if="collection.collection.type == 'sales'">Til salgs</span>
            </p>
            <h1>{{collection.collection.title}}</h1>
            <p class="description">{{collection.collection.description}}</p>
            <p class="byline">
                Opprettet av: <a ng-href="/#!/user/{{collection.user.slug}}">{{collection.user.nick}}</a>
                &bull; {{collection.games.length-1}} spill</p>

                

        </div>
        

    </div>
    <div class="filter-row">
            <form class="navbar-form">
            <div class="form-group">
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon1"><span class="glyphicon glyphicon-search"></span></span>
                    <input type="text" class="form-control" placeholder="Filter" ng-model="toggles.filterPhrase">
                </div>
            </div>
            </form>
    </div>
    <div class="fluid-container">
        <table class="table game-list">
            <thead>
            	<tr>
                    <th class="game-list-controls"><span class="glyphicon glyphicon-asterisk"></span></th>
                    <th >#</th>
            		<th ng-repeat="setting in collection.settings" ng-click="sortBy(collection.games, setting.field)">
            			{{setting.name}}
                        <span class="glyphicon glyphicon-menu-down pull-right" ng-if="toggles.sortOrder == setting.field"></span>
                        <span class="glyphicon glyphicon-menu-up pull-right" ng-if="toggles.sortOrder == '-' + setting.field"></span>
            			<!--<p>{{setting.description}}</p>-->
            		</th>
            	</tr>
            </thead>
            <tbody>
            	<tr class="game-row" ng-repeat="game in collection.games | filter:filterPhrase as filterPhraseList" ng-class="{
                'toggled': toggles['editGames'].indexOf(game) > -1
            }">
                    <td ng-class="{
                            'inactive': game.inactive
                        }" class="game-list-controls">
                        <label class="game-toggle-label"  ng-if="!game.inactive">
                            <input type="checkbox" name="game-toggle" ng-click="toggleGameInEditList(game)">
                        </label>
                    </td>
                    <td ng-class="{
                            'inactive': game.inactive
                        }" class="context-menu-container"><span ng-if="!game.inactive">{{$index+1}}</span>
                    <!--    
                    <button class="context-menu glyphicon glyphicon-menu-hamburger" ng-class="{
                        'selected': toggles['contextMenu'] == game._id
                    }" ng-click="toggleGameToggle(game._id, 'contextMenu')" ng-if="!game.inactive">
                    </button>
                    
                    <ul class="context-menu-list" ng-show="toggles['contextMenu'] == game._id">
                        <li ng-click="removeGame(game)">
                            <span class="description"><span class="glyphicon glyphicon-remove"> </span> Slett rad</span>
                        </li>
                        <li>
                            <span class="description"><span class="glyphicon glyphicon-share-alt"></span> Flytt rad til annen liste</span>
                        </li>
                        <li>
                            <span class="description"><span class="glyphicon glyphicon-copy"></span> Kopier rad til annen liste</span>
                        </li>
                        <li>
                            <span class="description"><span class="glyphicon glyphicon-duplicate"></span> Dupliker rad i denne listen</span>
                        </li>
                    </ul>
                    -->
                    </td>
            		<td ng-repeat="(settingKey, setting) in collection.settings" class="editable-col" contenteditable="true" ng-model="game[settingKey]" ng-keydown="gameKeyHandler($event, game, settingKey)" ng-change="updateGame(game, game[settingKey], settingKey)">
            		</td>
            	</tr>
            </tbody>
        </table>
    </div> 
</div>

<nav class="navbar navbar-default bottom-navbar" ng-if="toggles['editGames'].length">
            <div class="container-fluid">
            <p class="navbar-text">
            {{toggles['editGames'].length}} rader valgt</p>
            
            <button type="button" class="btn btn-default navbar-btn">Utfør</button>
            </div>
        </nav>